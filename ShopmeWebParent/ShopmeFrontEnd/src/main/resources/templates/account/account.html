<!DOCTYPE html>
<html lang="en"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      xmlns:th="http://www.thymeleaf.org"
>
<head th:replace="fragments/common/head :: content('none')"></head>


<body>

<div th:replace="fragments/common/header :: content"></div>

<!-- ========== MAIN CONTENT ========== -->
<main id="content" role="main">
    <!-- breadcrumb -->
    <div class="bg-gray-13 bg-md-transparent">
        <div class="container">
            <!-- breadcrumb -->
            <div class="my-md-3">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-3 flex-nowrap flex-xl-wrap overflow-auto overflow-xl-visble">
                        <li class="breadcrumb-item flex-shrink-0 flex-xl-shrink-1"><a th:href="@{/}">Home</a></li>
                        <li aria-current="page" class="breadcrumb-item flex-shrink-0 flex-xl-shrink-1 active">Profile</li>
                    </ol>
                </nav>
            </div>
            <!-- End breadcrumb -->
        </div>
    </div>
    <!-- End breadcrumb -->

    <section class="py-5 my-5 settings js-validate">
        <div class="container">
            <div th:if="${message != null && message != 'Invalid Current Password'}" class="alert alert-success alert-dismissible" role="alert">
                [[${message}]]
                <button type="button" class="btn-close float-right" data-dismiss="alert" aria-label="Close"></button>
            </div>
            <div th:if="${message != null && message == 'Invalid Current Password'}" class="alert alert-danger alert-dismissible" role="alert">
                [[${message}]]
                <button type="button" class="btn-close float-right" data-dismiss="alert" aria-label="Close"></button>
            </div>
            <div class="bg-white shadow rounded-lg d-block d-sm-flex">
                <div class="profile-tab-nav border-right">
                    <div class="p-4">
                        <div class="img-circle text-center mb-3">
<!--                            <img src="img/user2.jpg" alt="Image" class="shadow">-->
                            <i class="bx bx-user bx-md"></i>
                        </div>
                        <h4 class="text-center" sec:authentication="principal.fullName"></h4>
                    </div>
                    <div class="nav flex-column nav-pills" id="v-pills-tab" aria-orientation="vertical">
                        <a class="nav-link active" id="account-tab" th:href="@{/account_details}" role="tab" aria-controls="account" aria-selected="true">
                            <i class="fa fa-home text-center mr-1"></i>
                            Account
                        </a>
                        <a class="nav-link" id="password-tab" data-toggle="pill" href="#password" role="tab" aria-controls="password" aria-selected="false">
                            <i class="fa fa-key text-center mr-1"></i>
                            Password
                        </a>
                        <a class="nav-link" id="address-tab" th:href="@{/address_book}" role="tab" aria-controls="address" aria-selected="false">
                            <i class="bx bxs-location-plus text-center mr-1"></i>
                            Address Book
                        </a>
                        <a class="nav-link" id="orders-tab" th:href="@{/orders}" role="tab" aria-controls="orders" aria-selected="false">
                            <i class="bx bxs-package text-center mr-1"></i>
                            Order
                        </a>
                    </div>
                </div>
                <div class="tab-content p-4 p-md-5 " id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="account" role="tabpanel" aria-labelledby="account-tab">

                        <div th:replace="account/account_fragment :: content"></div>

                    </div>
                    <div class="tab-pane fade" id="password" role="tabpanel" aria-labelledby="password-tab">
                        <form class="js-validate" method="post" th:action="@{/updatePassword}" id="passwordUpdateForm">
                            <input type="hidden" th:value="${customer.id}" name="id">
                            <h3 class="mb-4">Password Settings</h3>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <div class="js-form-message js-focus-state">
                                            <label class="sr-only">Current Password</label>
                                            <div class="input-group">
                                                <div class="input-group-prepend">
                                                            <span class="input-group-text">
                                                                <span class="fas fa-lock"></span>
                                                            </span>
                                                </div>
                                                <input type="password" class="form-control" name="currentPassword"minlength="8" maxlength="15"  placeholder="Password" aria-label="Password" aria-describedby="signupPasswordLabel" required
                                                       data-msg="Your password is invalid. Please try again."
                                                       data-error-class="u-has-error"
                                                       data-success-class="u-has-success">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                <div class="form-group">
                                    <div class="js-form-message js-focus-state">
                                        <label class="sr-only">New Password</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                            <span class="input-group-text" id="signupPasswordLabel">
                                                                <span class="fas fa-lock"></span>
                                                            </span>
                                            </div>
                                            <input type="password" class="form-control" name="password" id="signupPassword" minlength="8" maxlength="15" placeholder="Password" aria-label="Password" aria-describedby="signupPasswordLabel" required
                                                   data-msg="Your password is invalid. Please try again."
                                                   data-error-class="u-has-error"
                                                   data-success-class="u-has-success">
                                        </div>
                                    </div>
                                </div>
                                </div>
                                <!-- End Input -->

                                <!-- Form Group -->
                                <div class="col-md-6">
                                <div class="form-group">
                                    <div class="js-form-message js-focus-state">
                                        <label class="sr-only">Confirm Password</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                        <span class="input-group-text" id="signupConfirmPasswordLabel">
                                                            <span class="fas fa-key"></span>
                                                        </span>
                                            </div>
                                            <input type="password" class="form-control" name="confirmPassword" id="signupConfirmPassword" minlength="8" maxlength="15" placeholder="Confirm Password" aria-label="Confirm Password" aria-describedby="signupConfirmPasswordLabel" required
                                                   data-msg="Password does not match the confirm password."
                                                   data-error-class="u-has-error"
                                                   data-success-class="u-has-success">
                                        </div>
                                    </div>
                                </div>
                                </div>

                            </div>
                            <div>
                                <button type="submit" class="btn btn-primary">Update</button>
                                <button type="reset" class="btn btn-light">Cancel</button>
                            </div>

                        </form>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
<!-- ========== END MAIN CONTENT ========== -->

<div th:replace="fragments/common/footer :: content"></div>


<div th:replace="fragments/common/secondary_contents :: content"></div>

<div th:replace="fragments/login_register/sidebar_nav :: content"></div>

<div th:replace="fragments/common/modal :: modal_confirm"></div>

<!-- Go to Top -->
<a class="js-go-to u-go-to" data-compensation="#header"
   data-hide-effect="slideOutDown"
   data-offset-top="400"
   data-position='{"bottom": 15, "right": 15 }'
   data-show-effect="slideInUp"
   data-type="fixed"
   href="my-account.html#">
    <span class="fas fa-arrow-up u-go-to__inner"></span>
</a>
<!-- End Go to Top -->

<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<!-- JS Global Compulsory -->
<script th:src="@{/assets/vendor/jquery/dist/jquery.min.js}"></script>
<script th:src="@{/assets/vendor/jquery-migrate/dist/jquery-migrate.min.js}"></script>
<script th:src="@{/assets/vendor/popper.js/dist/umd/popper.min.js}"></script>
<script th:src="@{/assets/vendor/bootstrap/bootstrap.min.js}"></script>

<!-- JS Implementing Plugins -->

<script th:src="@{/assets/vendor/appear.js}"></script>
<script th:src="@{/assets/vendor/jquery.countdown.min.js}"></script>
<script th:src="@{/assets/vendor/hs-megamenu/src/hs.megamenu.js}"></script>
<script th:src="@{/assets/vendor/svg-injector/dist/svg-injector.min.js}"></script>
<script th:src="@{/assets/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js}"></script>
<script th:src="@{/assets/vendor/jquery-validation/dist/jquery.validate.min.js}"></script>
<script th:src="@{/assets/vendor/fancybox/jquery.fancybox.min.js}"></script>
<script th:src="@{/assets/vendor/ion-rangeslider/js/ion.rangeSlider.min.js}"></script>
<script th:src="@{/assets/vendor/typed.js/lib/typed.min.js}"></script>
<script th:src="@{/assets/vendor/slick-carousel/slick/slick.js}"></script>
<script th:src="@{/assets/vendor/appear.js}"></script>
<script th:src="@{/assets/vendor/bootstrap-select/dist/js/bootstrap-select.min.js}"></script>


<!-- JS Electro -->
<script th:src="@{/assets/js/hs.core.js}"></script>
<script th:src="@{/assets/js/components/hs.countdown.js}"></script>
<script th:src="@{/assets/js/components/hs.header.js}"></script>
<script th:src="@{/assets/js/components/hs.hamburgers.js}"></script>
<script th:src="@{/assets/js/components/hs.unfold.js}"></script>
<script th:src="@{/assets/js/components/hs.focus-state.js}"></script>
<script th:src="@{/assets/js/components/hs.malihu-scrollbar.js}"></script>
<script th:src="@{/assets/js/components/hs.validation.js}"></script>
<script th:src="@{/assets/js/components/hs.fancybox.js}"></script>
<script th:src="@{/assets/js/components/hs.onscroll-animation.js}"></script>
<script th:src="@{/assets/js/components/hs.slick-carousel.js}"></script>
<script th:src="@{/assets/js/components/hs.quantity-counter.js}"></script>
<script th:src="@{/assets/js/components/hs.range-slider.js}"></script>
<script th:src="@{/assets/js/components/hs.show-animation.js}"></script>
<script th:src="@{/assets/js/components/hs.svg-injector.js}"></script>
<script th:src="@{/assets/js/components/hs.scroll-nav.js}"></script>
<script th:src="@{/assets/js/components/hs.go-to.js}"></script>
<script th:src="@{/assets/js/components/hs.selectpicker.js}"></script>
<script th:src="@{/assets/js/toast.js}"></script>
<script th:src="@{/assets/js/sweetalert.min.js}"></script>

<script>
    contextPath = "[[@{/}]]";
    var dropDownCountry;
    var dataListState;
    var fieldState;


    $(document).ready(function (){
        dropDownCountry = $("#country");
        dataListState = $("#listStates");
        fieldState = $("#states");

        dropDownCountry.on("change", function (){
            loadStatesForCountry();
            fieldState.val("").focus();
        })

    });

    function submitForm(form){
        action = form.attr('action').val();
        console.log("")
        form.action = contextPath + action
        form.method = 'post'
        form.submit();
    }

    function loadStatesForCountry(){
        selectedCountry = $("#country option:selected");
        countryId = selectedCountry.val();
        url = contextPath + "states/list_states_by_country/" + countryId;

        $.get(url, function (responseJSON){
            dataListState.empty();

            $.each(responseJSON, function (index, state){
                $("<option>").val(state.name).text(state.name).appendTo(dataListState);
            });
        }).fail(function (){
            error("Could not connect to server");
        });
    }


    $(window).on('load', function () {
        // initialization of HSMegaMenu component
        $('.js-mega-menu').HSMegaMenu({
            event: 'hover',
            direction: 'horizontal',
            pageContainer: $('.container'),
            breakpoint: 767.98,
            hideTimeOut: 0
        });
    });

    $(document).on('ready', function () {
        // initialization of header
        $.HSCore.components.HSHeader.init($('#header'));

        // initialization of animation
        $.HSCore.components.HSOnScrollAnimation.init('[data-animation]');

        // initialization of unfold component
        $.HSCore.components.HSUnfold.init($('[data-unfold-target]'), {
            afterOpen: function () {
                $(this).find('input[type="search"]').focus();
            }
        });

        // initialization of HSScrollNav component
        $.HSCore.components.HSScrollNav.init($('.js-scroll-nav'), {
            duration: 700
        });

        // initialization of quantity counter
        $.HSCore.components.HSQantityCounter.init('.js-quantity');

        // initialization of popups
        $.HSCore.components.HSFancyBox.init('.js-fancybox');

        // initialization of countdowns
        var countdowns = $.HSCore.components.HSCountdown.init('.js-countdown', {
            yearsElSelector: '.js-cd-years',
            monthsElSelector: '.js-cd-months',
            daysElSelector: '.js-cd-days',
            hoursElSelector: '.js-cd-hours',
            minutesElSelector: '.js-cd-minutes',
            secondsElSelector: '.js-cd-seconds'
        });

        // initialization of malihu scrollbar
        $.HSCore.components.HSMalihuScrollBar.init($('.js-scrollbar'));

        // initialization of forms
        $.HSCore.components.HSFocusState.init();

        // initialization of form validation
        $.HSCore.components.HSValidation.init('.js-validate', {
            rules: {
                confirmPassword: {
                    equalTo: '#signupPassword'
                }
            }
        });

        // initialization of forms
        $.HSCore.components.HSRangeSlider.init('.js-range-slider');

        // initialization of show animations
        $.HSCore.components.HSShowAnimation.init('.js-animation-link');

        // initialization of fancybox
        $.HSCore.components.HSFancyBox.init('.js-fancybox');

        // initialization of slick carousel
        $.HSCore.components.HSSlickCarousel.init('.js-slick-carousel');

        // initialization of go to
        $.HSCore.components.HSGoTo.init('.js-go-to');

        // initialization of hamburgers
        $.HSCore.components.HSHamburgers.init('#hamburgerTrigger');

        // initialization of unfold component
        $.HSCore.components.HSUnfold.init($('[data-unfold-target]'), {
            beforeClose: function () {
                $('#hamburgerTrigger').removeClass('is-active');
            },
            afterClose: function() {
                $('#headerSidebarList .collapse.show').collapse('hide');
            }
        });

        $('#headerSidebarList [data-toggle="collapse"]').on('click', function (e) {
            e.preventDefault();

            var target = $(this).data('target');

            if($(this).attr('aria-expanded') === "true") {
                $(target).collapse('hide');
            } else {
                $(target).collapse('show');
            }
        });

        // initialization of unfold component
        $.HSCore.components.HSUnfold.init($('[data-unfold-target]'));

        // initialization of select picker
        $.HSCore.components.HSSelectPicker.init('.js-select');
    });
</script>
</body>
</html>
